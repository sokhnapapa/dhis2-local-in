
<script>

  function drillDownResult(evt, selVal )
  {
    evt.target.href = "drillDownResult.action?selectedValues="+selVal;
  }
    
// Chart Display Option change start

  function chartTypeOptionChange(evt)
   {
     
     
     var chartTypeOptionList = document.getElementById("chartTypeOption");
     var chartTypeOptionValue = chartTypeOptionList.options[ chartTypeOptionList.selectedIndex ].value;
     
    // var tempICount = $selectedServiceList.size();
    
    // alert(chartTypeOptionValue);
     
     var chartDisplayOptionList = document.getElementById("chartDisplayOption");
     var chartDisplayOptionValue = chartDisplayOptionList.options[ chartDisplayOptionList.selectedIndex ].value;
     
    // alert(chartDisplayOptionValue);   

     iframeForChart.location.href = "generateChart1.action?currentChart="+chartTypeOptionValue+"&chartDisplayOption="+chartDisplayOptionValue;
     
   }

// Chart Display Option change for sorting

   function chartDisplayOptionChange(evt)
   {

     var chartTypeOptionList = document.getElementById("chartTypeOption");
     var chartTypeOptionValue = chartTypeOptionList.options[ chartTypeOptionList.selectedIndex ].value;   
 
     var chartDisplayOptionList = document.getElementById("chartDisplayOption");
     var chartDisplayOptionValue = chartDisplayOptionList.options[ chartDisplayOptionList.selectedIndex ].value;
  
   //  iframeForChart.location.href = "generateChart1.action?currentChart="+chartNamesToView[chartType][indexForChart]+"&chartDisplayOption="+chartDisplayOptionValue;
     
     iframeForChart.location.href = "generateChart1.action?currentChart="+chartTypeOptionValue+"&chartDisplayOption="+chartDisplayOptionValue;
       
     getSortedList(chartDisplayOptionValue);     
   }

function getSortedListForSummary()
{
     var chartDisplayOptionList = document.getElementById("chartDisplayOption");
     var chartDisplayOptionValue = chartDisplayOptionList.options[ chartDisplayOptionList.selectedIndex ].value;

     getSortedList(chartDisplayOptionValue);
}

function getSortedList(chartDisplayOptionValue)
{
    //var url = "getSortedData.action?chartDisplayOption=" + chartDisplayOptionValue;
        
    var request = new Request();
    request.setResponseTypeXML( 'messages' );
    request.setCallbackSuccess( getSortedListReceived );
    //request.send( url );

    var requestString = "getSortedDataElement.action";
    var params = "chartDisplayOption=" + chartDisplayOptionValue;
    request.sendAsPost( params );
    request.send( requestString );
}

function getSortedListReceived(xmlObject)
{   
    var messages = xmlObject.getElementsByTagName("message");
    document.getElementById("headingInfoId").innerHTML = "";
    document.getElementById("testId").value = "";
    
    for ( var i = 0; i < messages.length; i++ )
    {
        var hinfo = messages[ i ].firstChild.nodeValue;
        //document.getElementById("headingInfoId").innerHTML += hinfo;
        document.getElementById("testId").value += hinfo;
    }
    
    document.getElementById("headingInfoId").innerHTML = document.getElementById("testId").value;           
}

//fucction for selected Button is ViewChart

function exportToExcelFunction1( summaryOption )
	{
	    //alert("inside Viw Summary:" + summaryOption );
	    var chartDisplayOptionList = document.getElementById("chartDisplayOption");
	    var chartDisplayOptionValue = chartDisplayOptionList.options[ chartDisplayOptionList.selectedIndex ].value;
	    
	    document.getElementById("exportExcelAnchor1").href="exportDataElementsToExcel.action?viewSummary="+summaryOption+"&chartDisplayOption="+chartDisplayOptionValue;
	
	}
 
function exportDataStatusResultToWorkBook()
	{               
	    document.getElementById('htmlCode').value = document.getElementById('formResult').innerHTML;                                
	
	    return true;                
	}

//fucction for selected Button is ViewSummary

function exportToExcelFunction2( summaryOption )
	{
	   // alert("inside Viw Summary" + summaryOption );
	    var chartDisplayOptionList = document.getElementById("chartDisplayOption");
	    var chartDisplayOptionValue = chartDisplayOptionList.options[ chartDisplayOptionList.selectedIndex ].value;
	    
	    document.getElementById("exportExcelAnchor2").href="exportDataElementsToExcel.action?viewSummary="+summaryOption+"&chartDisplayOption="+chartDisplayOptionValue;
	
	}

</script>
<div align="right" class="NormalB">
    <table>
        <tr>
			<td class="NormalB">
			   #if($selectedButton.equals("ViewSummary"))
			          
			  <td class="NormalB"><a id="exportExcelAnchor2" name="exportExcelAnchor2" href="#" onclick="javascript:exportToExcelFunction2('yes')" target="_blank">Export To WorkBook</a></td>
			  <td class="NormalB">&nbsp;&nbsp;
			            <select id="chartDisplayOption" name="chartDisplayOption" onchange="getSortedListForSummary()">
			                <option value="none">Select Sort Type</option>
			                <option value="ascend">Ascending</option>
			                <option value="desend">Desending</option>
			                <option value="alphabet">Alphabetical</option>
			            </select>
			            &nbsp;&nbsp;
			  <br><br>
			 </td>
     </tr>      
     #else    
     <tr>        
		<td class="NormalB"><a id="exportExcelAnchor1" name="exportExcelAnchor1" href="#" onclick="javascript:exportToExcelFunction1('no')" target="_blank">Export To Excel</a></td>
		<td class="NormalB">&nbsp;&nbsp;<!--<font face="Arial, Helvetica, sans-serif" color="#000000">-->
		            <select id="chartTypeOption" name="chartTypeOption" onchange="chartTypeOptionChange(event)">
		                <option value="Vertical3DBarChart">Vertical 3D BarChart</option>
		                <option value="Horizontal3DBarChart">Horizontal 3D BarChart</option>
		                <option value="LineChart">Line Chart</option>
		                <option value="LineAndBarChart">Line And BarChart</option>
		                 <option value="AreaChart" >Area Chart</option>
		            </select>
		            &nbsp;&nbsp;
		            <select id="chartDisplayOption" name="chartDisplayOption" onchange="chartDisplayOptionChange(event)">
		                <option value="none">Select Sort Type</option>
		                <option value="ascend">Ascending</option>
		                <option value="desend">Desending</option>
		                <option value="alphabet">Alphabetical</option>
		            </select>
		</td>        
    </tr>            
   #end 
</table>             
</div> 
<div id="formResult">
	<div id="headingInfoId">
		<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-style: dotted" bordercolor="#111111" width="100%">                
		    <tr>
		        <td class="TableHeadingCellStyles" style="border-style: dotted; border-width: 1">Data Element Name</td>
		        #foreach($xaxisvalue in $dataElementChartResult.categories)
		          <td class="TableHeadingCellStyles" align="center" style="border-style: dotted; border-width: 1">$xaxisvalue</td>                   
		        #end
		    </tr>      
			    #set($count1 = 0)
			    #set( $count3 = 0 )                      
			    #foreach($onedataList in $dataElementChartResult.data)  
			    <!--	#set( $dataElementList = $dataElementChartResult.series )-->
			     <!--    #set( $dataElementList = $dataElementChartResult.getSeries() )-->
		      <tr>
		        <td class="TableHeadingCellStyles" style="border-style: dotted; border-width: 1">$yseriesList.get($count1)</td>
		          <!--  <td class="TableHeadingCellStyles" style="border-style: dotted; border-width: 1">$dataElementChartResult.series[$count1]</td>-->
		           #foreach($data in $onedataList)
		          <!--  #if( $categoryLB.equals( "period" ) && !$ougSetCB && $riRadio.equals( "dataElementsRadio" ) && $selectedStatus.get($count3).equals("yes") )
		                <td class="TableDataCellStyles" align="center" style="border-style: dotted; border-width: 1"><a href="#" onclick="javascript:drillDownResult( event, '$selectedValues.get($count3)' )" target="_blank">$data</a></td>                                    
		                #set( $count3 = $count3 + 1 )
		            #else-->
		            #if( $categoryLB.equals( "period" ) && !$ougGroupSetCB && $selectedStatus.get($count1).equals("yes") )
                         <td class="TableDataCellStyles" align="center" style="border-style: dotted; border-width: 1"><a href="#" onclick="javascript:drillDownResult( event, '$selectedValues.get($count3)' )" target="_blank">$data</a></td>                                    
                    #set( $count3 = $count3 + 1 ) 
                    #else
		                <td class="TableDataCellStyles" align="center" style="border-style: dotted; border-width: 1">$data</td>
		            #end
		          #end
		        #end
		        #set( $count1 = $count1 + 1 )
		      </tr>    
		    #end    
		</table>
	</div>
#if($selectedButton.equals("ViewSummary"))
    <br><br>
     #else
     <br>
         <div align="center">
             <iframe name="iframeForChart" id="iframeForChart" src="generateChart1.action?currentChart=Vertical3DBarChart" width="850px" height="550px" scrolling=auto frameborder="0"></iframe>
         </div>    
         <br>
     #end
</div> 
        <textarea id="testId" rows="10" cols="70" style="display:none">&nbsp;</textarea>                                                                        
</form>

    